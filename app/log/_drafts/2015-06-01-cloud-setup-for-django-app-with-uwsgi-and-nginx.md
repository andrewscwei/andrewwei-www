---
published: true
title: Cloud Setup for Django App with uWSGI and Nginx
tags: 
  - systems
---

This log demonstrates how to set up a Django app on a cloud VM instance and serve it using uWSGI and Nginx from **scratch**. Note the following assumptions:

1.	The app will be served on a Linux system.
2.	The app is living in an existing [Git](https://git-scm.com) repo.
3. 	The database which the app uses will be set up in the same VM instance as the app.
4. 	The app uses [Gulp](http://gulpjs.com) as its asset pipeline, hence requiring [Node.js](https://nodejs.org) as its dependency.
5.	The app is generated by [generator-vars-django](https://github.com/VARIANTE/generator-vars-django).

#4 and #5 above are optional.

Let's begin.

## Installing Dependencies

1.	Update APT packages, no explanations needed.
    ```
    $ sudo apt-get update
    ```

2.	Install [Git](https://git-scm.com) to pull down the app's source code.
    ```
    $ sudo apt-get install git-core
    ```
   
3.	Install [Upstart](http://upstart.ubuntu.com) if the system is still using [SysVinit](https://wiki.archlinux.org/index.php/SysVinit). This will make writing startup scripts much easier later on.
    ```
    $ sudo apt-get install upstart
    ```
	When prompted, enter 'Yes, do as I say!'.

4.	Install `nvm` so you have the freedom to juggle between different `npm` versions. Install it globally to save yourself from the trouble of managing global node packages later on. This allows you to run `nvm` with `sudo`. Follow this [guide](https://github.com/xtuple/nvm) or simply run:
    ```
    $ sudo wget -qO- https://raw.githubusercontent.com/xtuple/nvm/master/install.sh | sudo bash
    ```

5. 	Install `node` via `nvm`. Pick the version of your choice.
```
$ sudo nvm ls-remote
$ sudo nvm install x.xx.x
```

6.	Install `gulp` globally to build the app (assuming you have [Gulp](http://gulpjs.com) setup, which comes with [generator-vars-django](https://github.com/VARIANTE/generator-vars-django):
```
sudo npm install -g gulp
```

7. 	Install `python` and `pip` as needed by any Django app.
```
$ sudo apt-get install python-pip python-virtualenv python-dev build-essential
```

8. 	Install database of your choice. Here are a couple examples:
	##### MySQL
    	```
        $ sudo apt-get install mysql-server
		$ sudo apt-get install python-mysqldb
		```
    ##### PostgreSQL
    	```
        $ sudo apt-get install libpq-dev python-dev python-psycopg2
		$ sudo apt-get install postgresql postgresql-contrib
        ```
       
9.	Install uWSGI. Do it through `pip` instead of `apt-get` to get the most updated version.
	```
    $ sudo pip install uwsgi
    ```
    
10.	Install Nginx:
	```
    $ sudo apt-get install nginx
    ```

## Database Configuration

You will need to set up your database before you can run a Django app (if you are not using SQLite). Basically you need to create a new database with a new owner and password. Here are a couple examples for MySQL and PostgreSQL:

##### MySQL

```
$ mysql_secure_installation
$ mysql --user=root --password={password}
$ mysql> create database {db_name};
$ mysql> quit;
```

##### PostgreSQL

```
$ sudo su postgres
$ createuser --interactive -P
$ createdb --owner username dbname
```





